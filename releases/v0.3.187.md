Fix macro naming/renaming not persisting on save

saveMacro() was writing raw editor content directly to file when content
was provided, ignoring the name/description form fields. Now extracts
body from content and rebuilds file with form field values taking
precedence over embedded headers.
